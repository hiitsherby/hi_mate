<% include ../partials/header %>
	<header class="jumbotron">
		<h1>Welcome to hiMate</h1>
		<p>Find your mates from all over the campus.</p>
		<a class="btn btn-primary btn-lg" href="dashboard/new">Add New Mate</a>
	</header>
	<div class="row">
	<div class="col-lg-10 col-md-10 col-sm-10" id="map" height="460px" width="100%"></div>
    <!--<div id="form">-->
    <!--  <table>-->
    <!--  <tr><td>Name:</td> <td><input type='text' id='name'/> </td> </tr>-->
    <!--  <tr><td>Address:</td> <td><input type='text' id='address'/> </td> </tr>-->
    <!--  <tr><td>Type:</td> <td><select id='type'> +-->
    <!--             <option value='bar' SELECTED>bar</option>-->
    <!--             <option value='restaurant'>restaurant</option>-->
    <!--             </select> </td></tr>-->
    <!--             <tr><td></td><td><input type='button' value='Save' onclick='saveData()'/></td></tr>-->
    <!--  </table>-->
    <!--</div>-->
    </div>
	<br/>
	<div class="row text-center" style="display:flex; flex-wrap:wrap">
		<% content.forEach(function(x){ %>
		<div class="col-md-3 col-sm-6">
			<div class="thumbnail">	
				<h4><%= x.title %></h3>
				<div class="caption">
					<p>
						<a class="btn btn-primary" href="/dashboard/<%= x._id %>">More Info</a>
					</p>
					<h5>Tags: <%= x.hashtags %></h5>
				</div>						
			</div>
		</div>
		<% }) %>
	</div>

   <script>
      function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 3,
          center: {lat: -28.024, lng: 140.887}
        });

        // Create an array of alphabetical characters used to label the markers.
        var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.
        var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            label: labels[i % labels.length]
          });
        });

        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
      }
      var locations = <%= locations %>
      // var locations = [
      //   {lat: -31.563910, lng: 147.154312},
      //   {lat: -33.718234, lng: 150.363181},
      //   {lat: -33.727111, lng: 150.371124},
      //   {lat: -33.848588, lng: 151.209834},
      //   {lat: -33.851702, lng: 151.216968},
      //   {lat: -34.671264, lng: 150.863657},
      //   {lat: -35.304724, lng: 148.662905},
      //   {lat: -36.817685, lng: 175.699196},
      //   {lat: -36.828611, lng: 175.790222},
      //   {lat: -37.750000, lng: 145.116667},
      //   {lat: -37.759859, lng: 145.128708},
      //   {lat: -37.765015, lng: 145.133858},
      //   {lat: -37.770104, lng: 145.143299},
      //   {lat: -37.773700, lng: 145.145187},
      //   {lat: -37.774785, lng: 145.137978},
      //   {lat: -37.819616, lng: 144.968119},
      //   {lat: -38.330766, lng: 144.695692},
      //   {lat: -39.927193, lng: 175.053218},
      //   {lat: -41.330162, lng: 174.865694},
      //   {lat: -42.734358, lng: 147.439506},
      //   {lat: -42.734358, lng: 147.501315},
      //   {lat: -42.735258, lng: 147.438000},
      //   {lat: -43.999792, lng: 170.463352}
      // ]
    </script>
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
    </script>
   <script>// add user-add data on map
      //var map;
      //var marker;
      //var infowindow;
      //var messagewindow;

      //function initMap() {
      //  var california = {lat: -37.796280, lng: 144.961245}; 
      //  map = new google.maps.Map(document.getElementById('map'), {
      //    center: california,
      //    zoom: 13
      //  });

      //  infowindow = new google.maps.InfoWindow({
      //    content: document.getElementById('form')
      //  });

      //  messagewindow = new google.maps.InfoWindow({
      //    content: document.getElementById('message')
      //  });

      //  google.maps.event.addListener(map, 'click', function(event) {
      //    marker = new google.maps.Marker({
      //      position: event.latLng,
      //      map: map
      //    });


      //    google.maps.event.addListener(marker, 'click', function() {
      //      infowindow.open(map, marker);
      //    });
      //  });
      //}

      //function saveData() {
      //  var name = escape(document.getElementById('name').value);
      //  var address = escape(document.getElementById('address').value);
      //  var type = document.getElementById('type').value;
      //  var latlng = marker.getPosition();
      //  var url = 'https://hiitsherby:WenYen0u0@ds123926.mlab.com:23926/himate';

      //  downloadUrl(url, function(data, responseCode) {

      //    if (responseCode == 200 && data.length <= 1) {
      //      infowindow.close();
      //      messagewindow.open(map, marker);
      //    }
      //  });
      //}

      //function downloadUrl(url, callback) {
      //  var request = window.ActiveXObject ?
      //      new ActiveXObject('Microsoft.XMLHTTP') :
      //      new XMLHttpRequest;

      //  request.onreadystatechange = function() {
      //    if (request.readyState == 4) {
      //      request.onreadystatechange = doNothing;
      //      console.log('responseText',responseText);
      //      callback(request.responseText, request.status);
      //    }
      //  };

      //  request.open('GET', url, true);
      //  request.send(null);
      //}

      //function doNothing () {
      //}

    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD6WuNmyMxlCsDp-bkhkRAmaM1B_3smWkk&callback=initMap"></script>
<% include ../partials/footer %>